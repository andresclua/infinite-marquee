(function(v,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("gsap")):typeof define=="function"&&define.amd?define(["exports","gsap"],o):(v=typeof globalThis<"u"?globalThis:v||self,o(v.infiniteMarquee={},v.gsap))})(this,function(v,o){"use strict";function k(a,l){a=o.gsap.utils.toArray(a),l=l||{};let u=o.gsap.timeline({repeat:l.repeat,paused:l.paused,defaults:{ease:"none"},onReverseComplete:()=>u.totalTime(u.rawTime()+u.duration()*100)}),m=a.length,F=a[0].offsetLeft,e=[],h=[],x=[],s=0,P=(l.speed||1)*100,R=l.snap===!1?d=>d:o.gsap.utils.snap(l.snap||1),b,p,I,L,T,y;for(o.gsap.set(a,{xPercent:(d,c)=>{let M=h[d]=parseFloat(o.gsap.getProperty(c,"width","px"));return x[d]=R(parseFloat(o.gsap.getProperty(c,"x","px"))/M*100+o.gsap.getProperty(c,"xPercent")),x[d]}}),o.gsap.set(a,{x:0}),b=a[m-1].offsetLeft+x[m-1]/100*h[m-1]-F+a[m-1].offsetWidth*o.gsap.getProperty(a[m-1],"scaleX")+(parseFloat(l.paddingRight)||0),y=0;y<m;y++)T=a[y],p=x[y]/100*h[y],I=T.offsetLeft+p-F,L=I+h[y]*o.gsap.getProperty(T,"scaleX"),u.to(T,{xPercent:R((p-L)/h[y]*100),duration:L/P},0).fromTo(T,{xPercent:R((p-L+b)/h[y]*100)},{xPercent:x[y],duration:(p-L+b-p)/P,immediateRender:!1},L/P).add("label"+y,I/P),e[y]=I/P;function C(d,c){c=c||{},Math.abs(d-s)>m/2&&(d+=d>s?-m:m);let M=o.gsap.utils.wrap(0,m,d),A=e[M];return A>u.time()!=d>s&&(c.modifiers={time:o.gsap.utils.wrap(0,u.duration())},A+=u.duration()*(d>s?1:-1)),s=M,c.overwrite=!0,u.tweenTo(A,c)}return u.next=d=>C(s+1,d),u.previous=d=>C(s-1,d),u.current=()=>s,u.toIndex=(d,c)=>C(d,c),u.times=e,u.progress(1,!0).progress(0,!0),l.reversed&&(u.vars.onReverseComplete(),u.reverse()),u}function U(a,l){let u;return a=o.utils.toArray(a),l=l||{},o.context(()=>{let m=l.onChange,F=0,e=o.timeline({repeat:l.repeat,onUpdate:m&&function(){let t=e.closestIndex();F!==t&&(F=t,m(a[t],t))},paused:l.paused,defaults:{ease:"none"},onReverseComplete:()=>e.totalTime(e.rawTime()+e.duration()*100)}),h=a.length,x=a[0].offsetTop,s=[],P=[],R=[],b=[],p=0,I=l.center,L=t=>{let r={},n;for(n in t)r[n]=t[n];return r},T=(l.speed||1)*100,y=l.snap===!1?t=>t:o.utils.snap(l.snap||1),C=0,d=I===!0?a[0].parentNode:o.utils.toArray(I)[0]||a[0].parentNode,c,M=()=>a[h-1].offsetTop+b[h-1]/100*P[h-1]-x+R[0]+a[h-1].offsetHeight*o.getProperty(a[h-1],"scaleY")+(parseFloat(l.paddingBottom)||0),A=()=>{let t=d.getBoundingClientRect(),r;x=a[0].offsetTop,a.forEach((n,i)=>{P[i]=parseFloat(o.getProperty(n,"height","px")),b[i]=y(parseFloat(o.getProperty(n,"y","px"))/P[i]*100+o.getProperty(n,"yPercent")),r=n.getBoundingClientRect(),R[i]=r.top-(i?t.bottom:t.top),t=r}),o.set(a,{yPercent:n=>b[n]}),c=M()},E,Y=()=>{C=I?e.duration()*(d.offsetWidth/2)/c:0,I&&s.forEach((t,r)=>{s[r]=E(e.labels["label"+r]+e.duration()*P[r]/2/c-C)})},B=(t,r,n)=>{let i=t.length,f=1e10,g=0,w;for(;i--;)w=Math.abs(t[i]-r),w>n/2&&(w=n-w),w<f&&(f=w,g=i);return g},D=()=>{let t,r,n,i,f;for(e.clear(),t=0;t<h;t++)r=a[t],n=b[t]/100*P[t],i=r.offsetTop+n-x+R[0],f=i+P[t]*o.getProperty(r,"scaleY"),e.to(r,{yPercent:y((n-f)/P[t]*100),duration:f/T},0).fromTo(r,{yPercent:y((n-f+c)/P[t]*100)},{yPercent:b[t],duration:(n-f+c-n)/T,immediateRender:!1},f/T).add("label"+t,i/T),s[t]=i/T;E=o.utils.wrap(0,e.duration())},H=()=>{let{enterAnimation:t,leaveAnimation:r}=l,n=e.duration()/a.length;a.forEach((i,f)=>{let g=t&&t(i,n,f),w=g&&e.duration()-E(s[f]-Math.min(n,g.duration()))<n-.05;g&&e.add(g,w?0:E(s[f]-g.duration())),g=r&&r(i,n,f),w=s[f]===e.duration(),g&&g.duration()>n&&g.duration(n),g&&e.add(g,w?0:s[f])})},W=t=>{let r=e.progress();e.progress(0,!0),A(),t&&D(),Y(),H(),t&&e.draggable?e.time(s[p],!0):e.progress(r,!0)},X=()=>W(!0),S;o.set(a,{y:0}),A(),D(),Y(),H(),window.addEventListener("resize",X);function O(t,r){r=L(r),Math.abs(t-p)>h/2&&(t+=t>p?-h:h);let n=o.utils.wrap(0,h,t),i=s[n];return i>e.time()!=t>p&&(i+=e.duration()*(t>p?1:-1)),r.revolutions&&(i+=e.duration()*Math.round(r.revolutions),delete r.revolutions),(i<0||i>e.duration())&&(r.modifiers={time:E}),p=n,r.overwrite=!0,o.killTweensOf(S),e.tweenTo(i,r)}if(e.elements=a,e.next=t=>O(p+1,t),e.previous=t=>O(p-1,t),e.current=()=>p,e.toIndex=(t,r)=>O(t,r),e.closestIndex=t=>{let r=B(s,e.time(),e.duration());return t&&(p=r),r},e.times=s,e.progress(1,!0).progress(0,!0),l.reversed&&(e.vars.onReverseComplete(),e.reverse()),l.draggable&&typeof Draggable=="function"){S=document.createElement("div");let t=o.utils.wrap(0,1),r,n,i,f=()=>e.progress(t(n+(i.startY-i.y)*r)),g=()=>e.closestIndex(!0);typeof InertiaPlugin>"u"&&console.warn("InertiaPlugin required for momentum-based scrolling and snapping. https://gsap.com/pricing"),i=Draggable.create(S,{trigger:a[0].parentNode,type:"y",onPressInit(){o.killTweensOf(e),n=e.progress(),W(),r=1/c,o.set(S,{y:n/-r})},onDrag:f,onThrowUpdate:f,inertia:!0,snap:w=>{let q=-(w*r)*e.duration(),N=E(q),j=s[B(s,N,e.duration())],z=j-N;return Math.abs(z)>e.duration()/2&&(z+=z<0?e.duration():-e.duration()),(q+z)/e.duration()/-r},onRelease:g,onThrowComplete:g})[0],e.draggable=i}return e.closestIndex(!0),m&&m(a[p],p),u=e,()=>window.removeEventListener("resize",X)}),u}v.horizontalLoop=k,v.verticalLoop=U,Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})});
